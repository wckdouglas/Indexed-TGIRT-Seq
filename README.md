# Indexed-TGIRT-Seq

This folder contain scripts for tag-based error correction of TGIRT-seq developed by [Douglas Wu](mailto:wckdouglas@gmail.com).

Scripts:

* readClusterPairs.py:   Writing paired fastq files with concensus base from a cluster of reads. 
* pileupBam.py:         pileup bam file and  count the bases at each position column (depends on pysam) 



### readClusterPairs.py
```
usage: readClusterPairs.py [-h] -o OUTPUTPREFIX -1 FASTQ1 -2 FASTQ2
                           [-m CUTOFF] [-t THREADS] [-x IDXBASE]
                           [-q BARCODECUTOFF] [-f VOTECUTOFF] [-v] [-n]

Clustering fastq reads to fasta reads with the first $IDXBASE bases as cDNA-
synthesis barcode. Concensus bases are called only when the fraction of reads
that contain the concensus base exceed some threshold. Quality scores are
generated by the average score for the bases that matched concensus base.

optional arguments:
  -h, --help            show this help message and exit
  -o OUTPUTPREFIX, --outputprefix OUTPUTPREFIX
                        Paired end Fastq files with R1_001.fastq.gz as suffix
                        for read1, and R2_001.fastq.gz as suffix for read2
  -1 FASTQ1, --fastq1 FASTQ1
                        Paired end Fastq file 1 with four line/record
  -2 FASTQ2, --fastq2 FASTQ2
                        Paired end Fastq file 2 with four line/record
  -m CUTOFF, --cutoff CUTOFF
                        minimum read count for each read cluster (default: 4)
  -t THREADS, --threads THREADS
                        number of threads to use (default: 1)
  -x IDXBASE, --idxBase IDXBASE
                        how many base in 5\' end as index? (default: 13)
  -q BARCODECUTOFF, --barcodeCutOff BARCODECUTOFF
                        Average base calling quality for barcode sequence
                        (default=30)
  -f VOTECUTOFF, --voteCutOff VOTECUTOFF
                        The threshold of fraction in a position for a
                        concensus base to be called (default: 0.9)
  -v, --printScore      Printing score for each base to stdout (default:
                        False)
  -n, --retainN         Use N-containing sequence for concensus base vote and
                        output sequences containing N (defulat: False)
```
